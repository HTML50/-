# GULP.js

5月23日

（以前自己了解过grunt、gulp，由于没做过大的项目，小项目都是自己一行行码，也没感觉到效率低。也写过类似的自动化脚本，但是面试时老是问glup，webpack之类的使用经验，不如自己学习一下，平时也使用高级的工具来提高生产效率。）

（安装折腾了半天，因为之前装过，好久不用，GULP升级，跟以前不太一样，用老旧的经验不太管用，最后跟着官方文档走了一遍解决）

**Hello world**

```javascript
var gulp = require('gulp');

gulp.task('default', function() {
  // place code for your default task here
  console.log('hello world!')
});
```

配置好后，命令行`gulp`，显示hello world。



5月24日

由于脑子里没有工具的整个概念的画面，所以很多操作都是瞎折腾，即使跟着官方文档或其他教程，也会出现意料之外的错误，百般尝试，终于搞明白是怎么回事：

```javascript
var gulp = require('gulp'),
    uglify = require('gulp-uglify');

gulp.task('minjs', function () {
    gulp.src('src/js/*.js')
        .pipe(uglify())
        .pipe(gulp.dist('dist/'));
});

gulp.task('watch', function () {
    //gulp.watch(src_css+'/**/*.css',['mincss']);
    gulp.watch('src/js/*.js',['minjs']);
});


gulp.task('default', function() {
      gulp.run('minjs');
      gulp.run('watch');
});
```

多个任务弄不明白，先来设定一个任务。修改`gulpfile.js`如上，在项目目录下创建了`src/js`文件夹，在其中创建了一个`test.js`文件：

```javascript
console.log('test');
function test(){
  alert('this is a test')
}
```



命令行运行`gulp`后得到：

```json
[11:04:07] Using gulpfile ~\Documents\GitHub\gulpTest\gulpfile.js
[11:04:07] Starting 'default'...
gulp.run() has been deprecated. Use task dependencies or gulp.watch task triggering instead.
[11:04:07] Starting 'minjs'...
[11:04:07] Finished 'minjs' after 16 ms
[11:04:07] Starting 'watch'...
[11:04:07] Finished 'watch' after 15 ms
[11:04:07] Finished 'default' after 45 ms
[11:04:12] Starting 'minjs'...
[11:04:12] Finished 'minjs' after 4.19 ms
[11:04:40] Starting 'minjs'...
[11:04:40] Finished 'minjs' after 5.17 ms
```

看上去已经正常执行了，比起安装各种插件时报的各种错误的显示结果清爽多了。

由于刚开始未创建`dist`输出目录，反复修改`test.js`，发现没有任何反应。想了想，`Ctrl + C`结束gulp任务，创建`dist`目录，再次gulp执行任务，修改`test.js`，得到了自动生成的uglify js文件：

```javascript
function test(){alert("this is a test")}console.log("test");
```

需要注意的是，写js时要保证`;`的正确。



再增加以下`gulpfile.js`的内容：

```javascript
'use strict';

var gulp = require('gulp'),
    sass = require('gulp-sass'),
    uglify = require('gulp-uglify');

gulp.task('minjs', function () {
    gulp.src('src/js/*.js')
        .pipe(uglify())
        .pipe(gulp.dest('dist/'));
});

gulp.task('sass', function () {
  return gulp.src('src/scss/**/*.scss')
    .pipe(sass({outputStyle: 'compressed'}).on('error', sass.logError))
    .pipe(gulp.dest('dist/'));
});


gulp.task('default', function () {
    gulp.watch('src/js/*.js',['minjs']);
    gulp.watch('src/scss/**/*.scss', ['sass']);
});
```

增加了一个`sass`转`css`的模块，下面是测试用的`sass`文件：

```scss
$font-stack:Helvetica, sans-serif;
$primary-color: #333;
body {
  font: 100% $font-stack;
  color: $primary-color;
}
/* this is a test */
```

修改文件，自动得到编译好的css文件：

```css
body{font:100% Helvetica,sans-serif;color:#333}
```



5月25日

至此，gulp自动化打包基本上可以使用了，下面来研究一下如何完成一个真正的自动化流程。

综合考虑，这里对工具选取的原则是简单、易上手，使用Pug + less + coffeScript进行第一个HELLO WOLRD。



首先复习一下编码规范

http://www.css88.com/archives/5361



